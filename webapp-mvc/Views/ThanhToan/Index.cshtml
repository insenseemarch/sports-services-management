@model List<webapp_mvc.Controllers.ThanhToanItem>
@{
    ViewData["Title"] = "Thanh Toán Hóa Đơn";
}

<div class="container py-4">
    <h2 class="mb-4"><i class="fas fa-cash-register me-2"></i>Thanh Toán Hóa Đơn</h2>
    
    <div class="card shadow-sm border-0 mb-4">
        <div class="card-body">
             <form method="get">
                <div class="input-group">
                    <input type="text" name="search" class="form-control" placeholder="Tìm theo Mã Phiếu hoặc SĐT Khách..." value="@Context.Request.Query["search"]">
                    <button class="btn btn-primary">Tìm Kiếm</button>
                </div>
            </form>
        </div>
    </div>

    @if(Context.Request.Query["msg"].ToString().Length > 0)
    {
         <div class="alert alert-success">@Context.Request.Query["msg"]</div>
    }

    <div class="table-responsive">
        <table class="table table-hover align-middle">
            <thead class="bg-light">
                <tr>
                    <th>Mã Phiếu</th>
                    <th>Khách Hàng</th>
                    <th>Ngày Đặt</th>
                    <th>Sân</th>
                    <th>Tổng Hợp (San + DV)</th>
                    <th>Trạng Thái</th>
                    <th>Thao Tác</th>
                </tr>
            </thead>
            <tbody>
                @foreach(var item in Model)
                {
                    <tr>
                        <td class="fw-bold">@item.MaDatSan</td>
                        <td>@item.TenKhachHang</td>
                        <td>@item.NgayDat.ToString("dd/MM/yyyy")</td>
                        <td>@item.TenCoSo</td>
                        <td class="text-success fw-bold">
                            @item.TienSan.ToString("N0") + @item.TienDichVu.ToString("N0") = @item.TongTien.ToString("N0") đ
                        </td>
                        <td><span class="badge bg-warning text-dark">@item.TrangThai</span></td>
                        <td>
                            <a asp-action="Confirm" asp-route-id="@item.MaDatSan" class="btn btn-sm btn-success">
                                <i class="fas fa-money-bill-wave me-1"></i>Thanh Toán (Review)
                            </a>
                        </td>
                    </tr>
                }
            </tbody>
        </table>
        @if(Model.Count == 0) { <p class="text-center text-muted">Không có phiếu nào cần thanh toán.</p> }
    </div>
</div>
